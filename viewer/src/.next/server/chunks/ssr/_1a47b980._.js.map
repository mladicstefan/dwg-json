{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/djamla/Documents/code/cadalgo/fusioncad/src/app/%28public%29/%28homepage%29/page.tsx"],"sourcesContent":["'use client'\nimport React, { useEffect, useState, useRef } from 'react'\nimport Header from '../components/Header'\nimport Viewer from '../components/Viewer'\nimport StatusOverlay from '../components/StatusOverlay'\nimport { Model } from '../components/types'\n\nexport default function HomePage() {\n  const [models, setModels] = useState<Model[]>([])\n  const [selected, setSelected] = useState('')\n  const [busy, setBusy] = useState(false)\n  const [message, setMessage] = useState<string | null>(null)\n  const viewer = useRef<any>(null)\n\n  // fetch models\n  useEffect(() => {\n    fetch('/api/models').then(r => r.json()).then(setModels)\n  }, [])\n\n  // upload handler\n  const handleUpload = async (file: File) => {\n    setBusy(true)\n    setMessage(`Uploading ${file.name}...`)\n    const data = new FormData()\n    data.append('model-file', file)\n    if (file.name.endsWith('.zip')) {\n      const entry = prompt('ZIP entry file?')!\n      data.append('model-zip-entrypoint', entry)\n    }\n    await fetch('/api/models', { method: 'POST', body: data })\n    setModels(await fetch('/api/models').then(r=>r.json()))\n    setBusy(false)\n    setSelected(file.name)\n  }\n\n  // poll & load\n  useEffect(() => {\n    let id: number\n    const check = async () => {\n      if (!viewer.current || !selected) return\n      setMessage('Checking translation...')\n      const res = await fetch(`/api/models/${selected}/status`)\n      const st = await res.json()\n      if (st.status === 'inprogress') {\n        setMessage(`Translating (${st.progress})...`)\n        id = window.setTimeout(check, 5000)\n      } else if (st.status === 'failed') {\n        setMessage('Translation failed')\n      } else {\n        setMessage(null)\n        viewer.current.setLightPreset(0)\n        window.Autodesk.Viewing.Document.load(\n          'urn:'+selected,\n          (doc: any) => viewer.current.loadDocumentNode(doc, doc.getRoot().getDefaultGeometry()),\n          (_c, m) => console.error(m)\n        )\n      }\n    }\n    check()\n    return () => clearTimeout(id)\n  }, [selected])\n\n  return (\n    <div className=\"flex flex-col h-screen\">\n      <Header busy={busy} models={models} selected={selected} onSelect={setSelected} onUpload={handleUpload} />\n      {message && <StatusOverlay message={message} />}\n      <Viewer onViewerReady={v => (viewer.current = v)} />\n    </div>\n  )\n}"],"names":[],"mappings":";;;;AACA;;;;;;;;;;;;;;;;AADA;;;;;;AAOe,SAAS;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAW,EAAE;IAChD,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IACtD,MAAM,SAAS,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAO;IAE3B,eAAe;IACf,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,eAAe,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,IAAI,IAAI,CAAC;IAChD,GAAG,EAAE;IAEL,iBAAiB;IACjB,MAAM,eAAe,OAAO;QAC1B,QAAQ;QACR,WAAW,CAAC,UAAU,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC;QACtC,MAAM,OAAO,IAAI;QACjB,KAAK,MAAM,CAAC,cAAc;QAC1B,IAAI,KAAK,IAAI,CAAC,QAAQ,CAAC,SAAS;YAC9B,MAAM,QAAQ,OAAO;YACrB,KAAK,MAAM,CAAC,wBAAwB;QACtC;QACA,MAAM,MAAM,eAAe;YAAE,QAAQ;YAAQ,MAAM;QAAK;QACxD,UAAU,MAAM,MAAM,eAAe,IAAI,CAAC,CAAA,IAAG,EAAE,IAAI;QACnD,QAAQ;QACR,YAAY,KAAK,IAAI;IACvB;IAEA,cAAc;IACd,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI;QACJ,MAAM,QAAQ;YACZ,IAAI,CAAC,OAAO,OAAO,IAAI,CAAC,UAAU;YAClC,WAAW;YACX,MAAM,MAAM,MAAM,MAAM,CAAC,YAAY,EAAE,SAAS,OAAO,CAAC;YACxD,MAAM,KAAK,MAAM,IAAI,IAAI;YACzB,IAAI,GAAG,MAAM,KAAK,cAAc;gBAC9B,WAAW,CAAC,aAAa,EAAE,GAAG,QAAQ,CAAC,IAAI,CAAC;gBAC5C,KAAK,OAAO,UAAU,CAAC,OAAO;YAChC,OAAO,IAAI,GAAG,MAAM,KAAK,UAAU;gBACjC,WAAW;YACb,OAAO;gBACL,WAAW;gBACX,OAAO,OAAO,CAAC,cAAc,CAAC;gBAC9B,OAAO,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CACnC,SAAO,UACP,CAAC,MAAa,OAAO,OAAO,CAAC,gBAAgB,CAAC,KAAK,IAAI,OAAO,GAAG,kBAAkB,KACnF,CAAC,IAAI,IAAM,QAAQ,KAAK,CAAC;YAE7B;QACF;QACA;QACA,OAAO,IAAM,aAAa;IAC5B,GAAG;QAAC;KAAS;IAEb,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAO,MAAM;gBAAM,QAAQ;gBAAQ,UAAU;gBAAU,UAAU;gBAAa,UAAU;;;;;;YACxF,yBAAW,8OAAC;gBAAc,SAAS;;;;;;0BACpC,8OAAC;gBAAO,eAAe,CAAA,IAAM,OAAO,OAAO,GAAG;;;;;;;;;;;;AAGpD","debugId":null}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///home/djamla/Documents/code/cadalgo/fusioncad/src/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored[\n  'react-ssr'\n].ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,4HAAyBC,QAAQ,CACxD,YACD,CAACC,kBAAkB","ignoreList":[0],"debugId":null}}]
}